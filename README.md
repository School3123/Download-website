# Webpage Single-File Downloader 利用マニュアル

このアプリは、指定したWebページ（動的サイト含む）を画像やCSSごとダウンロードし、オフラインで閲覧可能な「単一のHTMLファイル」に変換するツールです。

---

## 📂 1. ファイル構成
GitHubリポジトリのルート（一番上の階層）に、以下の3つのファイルを作成・保存してください。

1.  **`requirements.txt`**（ライブラリ定義）
2.  **`bundler.py`**（変換ロジック本体）
3.  **`app.py`**（画面・操作パネル）

---

## 🛠 2. インストールと起動（GitHub Codespaces）

GitHub Codespacesを開き、画面下部のターミナルで以下の手順を実行してください。

### 手順 1: ライブラリのインストール
Pythonの必要なパッケージをインストールします。
```bash
pip install -r requirements.txt
```

### 手順 2: ブラウザエンジンのセットアップ（重要）
アプリが使用するブラウザ環境をインストールします。
※ これを行わないとエラーになります。
```bash
playwright install --with-deps
```
（完了まで数分かかる場合があります）

### 手順 3: アプリの起動
以下のコマンドを入力してアプリを立ち上げます。
```bash
streamlit run app.py
```

起動後、右下に表示されるポップアップの **「Open in Browser (ブラウザで開く)」** をクリックすると、アプリ画面が表示されます。

---

## 💻 3. アプリの使い方

### ① 言語設定（サイドバー）
画面左側のサイドバー（`<` アイコンで開閉可能）で設定を行います。

*   **Language / 言語**:
    *   アプリのメニューやボタンの表示言語（日本語 / 英語）を切り替えます。
*   **Target Content (Webページの言語設定)**:
    *   ダウンロードしたいWebサイトに対し、どの言語でアクセスするかを指定します。
    *   例: 多言語対応サイトで「English (en-US)」を選択すると、英語版のページが取得されます。

### ② 変換の実行
1.  **URL入力**: 真ん中の入力欄に、保存したいWebページのURLを貼り付けます。
2.  **実行**: 「変換・ダウンロード準備」ボタンを押します。
    *   *※ 動的サイトの場合、読み込みに数十秒かかることがあります。*

### ③ プレビューとダウンロード
変換が成功すると画面が分割され、以下が表示されます。

*   **左側（プレビュー）**: 保存されるページの見た目を確認できます。
*   **右側（ダウンロード）**: 「HTMLファイルをダウンロード」ボタンを押し、PCに保存してください。

---

## ⚠️ 4. 注意点とトラブルシューティング

**Q. 変換に時間がかかります**
*   **A.** 最近のWebサイト（SPA）に対応するため、ページが完全に表示されるまで待機する仕様になっています。また、スクロールして画像を読み込む処理も行っているため、完了まで1分程度かかる場合があります。

**Q. エラー「Timeout 30000ms exceeded」が出ます**
*   **A.** 通信が止まらないサイト（動画サイトや広告が多いサイト）で発生しますが、アプリは自動的にエラーを回避し、**その時点で取得できた内容**でHTMLを作成しようとします。そのままダウンロードして中身を確認してください。

**Q. ダウンロードしたファイルの画像が表示されません**
*   **A.** 基本的に画像はBase64形式で埋め込まれますが、特殊なJavaScriptで制御されている画像や、背景画像などは取得できない場合があります。

**Q. リンクをクリックするとどうなりますか？**
*   **A.** ダウンロードしたHTML内のリンクはすべて絶対パス（`https://～`）に変換されています。クリックすると、ブラウザの新しいタブで元のWebサイトへ移動します。
